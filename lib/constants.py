"""Constants and configuration data for Launch Control XL 3."""

from typing import List, Tuple, Dict

# MIDI and template constants
MAX_CC_VALUE = 127  
MIN_CC_VALUE = 1
DEFAULT_MIN_CC_VALUE = 5
MAX_MIDI_CHANNEL = 16
MIN_MIDI_CHANNEL = 1
MAX_INTERNAL_CHANNEL = 15
MIN_INTERNAL_CHANNEL = 0
DEFAULT_TEMPLATE_COUNT = 15

# Safe CC range to avoid reserved/problematic MIDI CCs
# CCs 1-12 are often reserved (mod wheel, breath, etc.)
# CCs 121-127 are channel mode messages
SAFE_CC_MIN = 13
SAFE_CC_MAX = 120

# Embedded SysEx messages 
EMBEDDED_MSGS = [
    b"\xf0\x00\x20\x29\x02\x15\x05\x00\x45\x00\x7f\x20\x10\x2a\x4e\x65\x77\x20\x43\x75\x73\x74\x6f\x6d\x20\x4d\x6f\x64\x65\x49\x10\x02\x05\x00\x01\x40\x00\x0d\x7f\x00\x49\x11\x02\x05\x00\x01\x40\x00\x0e\x7f\x00\x49\x12\x02\x05\x00\x01\x40\x00\x0f\x7f\x00\x49\x13\x02\x05\x00\x01\x40\x00\x10\x7f\x00\x49\x14\x02\x05\x00\x01\x40\x00\x11\x7f\x00\x49\x15\x02\x05\x00\x01\x40\x00\x12\x7f\x00\x49\x16\x02\x05\x00\x01\x40\x00\x13\x7f\x00\x49\x17\x02\x05\x00\x01\x40\x00\x14\x7f\x00\x49\x18\x02\x09\x00\x01\x40\x00\x15\x7f\x00\x49\x19\x02\x09\x00\x01\x40\x00\x16\x7f\x00\x49\x1a\x02\x09\x00\x01\x40\x00\x17\x7f\x00\x49\x1b\x02\x09\x00\x01\x40\x00\x18\x7f\x00\x49\x1c\x02\x09\x00\x01\x40\x00\x19\x7f\x00\x49\x1d\x02\x09\x00\x01\x40\x00\x1a\x7f\x00\x49\x1e\x02\x09\x00\x01\x40\x00\x1b\x7f\x00\x49\x1f\x02\x09\x00\x01\x40\x00\x1c\x7f\x00\x49\x20\x02\x0d\x00\x01\x40\x00\x1d\x7f\x00\x49\x21\x02\x0d\x00\x01\x40\x00\x1e\x7f\x00\x49\x22\x02\x0d\x00\x01\x40\x00\x1f\x7f\x00\x49\x23\x02\x0d\x00\x01\x40\x00\x20\x7f\x00\x49\x24\x02\x0d\x00\x01\x40\x00\x21\x7f\x00\x49\x25\x02\x0d\x00\x01\x40\x00\x22\x7f\x00\x49\x26\x02\x0d\x00\x01\x40\x00\x23\x7f\x00\x49\x27\x02\x0d\x00\x01\x40\x00\x24\x7f\x00\x60\x10\x60\x11\x60\x12\x60\x13\x60\x14\x60\x15\x60\x16\x60\x17\x60\x18\x60\x19\x60\x1a\x60\x1b\x60\x1c\x60\x1d\x60\x1e\x60\x1f\x60\x20\x60\x21\x60\x22\x60\x23\x60\x24\x60\x25\x60\x26\x60\x27\xf7",
    b"\xf0\x00\x20\x29\x02\x15\x05\x00\x45\x03\x7f\x20\x10\x2a\x4e\x65\x77\x20\x43\x75\x73\x74\x6f\x6d\x20\x4d\x6f\x64\x65\x49\x28\x02\x00\x00\x01\x40\x00\x05\x7f\x00\x49\x29\x02\x00\x00\x01\x40\x00\x06\x7f\x00\x49\x2a\x02\x00\x00\x01\x40\x00\x07\x7f\x00\x49\x2b\x02\x00\x00\x01\x40\x00\x08\x7f\x00\x49\x2c\x02\x00\x00\x01\x40\x00\x09\x7f\x00\x49\x2d\x02\x00\x00\x01\x40\x00\x0a\x7f\x00\x49\x2e\x02\x00\x00\x01\x40\x00\x0b\x7f\x00\x49\x2f\x02\x00\x00\x01\x40\x00\x0c\x7f\x00\x60\x28\x60\x29\x60\x2a\x60\x2b\x60\x2c\x60\x2d\x60\x2e\x60\x2f\x49\x30\x02\x19\x03\x01\x50\x00\x25\x7f\x00\x49\x31\x02\x19\x03\x01\x50\x00\x26\x7f\x00\x49\x32\x02\x19\x03\x01\x50\x00\x27\x7f\x00\x49\x33\x02\x19\x03\x01\x50\x00\x28\x7f\x00\x49\x34\x02\x19\x03\x01\x50\x00\x29\x7f\x00\x49\x35\x02\x19\x03\x01\x50\x00\x2a\x7f\x00\x49\x36\x02\x19\x03\x01\x50\x00\x2b\x7f\x00\x49\x37\x02\x19\x03\x01\x50\x00\x2c\x7f\x00\x49\x38\x02\x25\x03\x01\x50\x00\x2d\x7f\x00\x49\x39\x02\x25\x03\x01\x50\x00\x2e\x7f\x00\x49\x3a\x02\x25\x03\x01\x50\x00\x2f\x7f\x00\x49\x3b\x02\x25\x03\x01\x50\x00\x30\x7f\x00\x49\x3c\x02\x25\x03\x01\x50\x00\x31\x7f\x00\x49\x3d\x02\x25\x03\x01\x50\x00\x32\x7f\x00\x49\x3e\x02\x25\x03\x01\x50\x00\x33\x7f\x00\x49\x3f\x02\x25\x03\x01\x50\x00\x34\x7f\x00\x60\x30\x60\x31\x60\x32\x60\x33\x60\x34\x60\x35\x60\x36\x60\x37\x60\x38\x60\x39\x60\x3a\x60\x3b\x60\x3c\x60\x3d\x60\x3e\x60\x3f\xf7"
]

# Control map tuples: (msg_index, cc_pos, ch_pos, color_pos, flag_pos [-1 if none])
CONTROLS: List[Tuple[int, int, int, int, int]] = [
    (0,37,34,32,35), (0,48,45,43,46), (0,59,56,54,57), (0,70,67,65,68), (0,81,78,76,79),
    (0,92,89,87,90), (0,103,100,98,101), (0,114,111,109,112), (0,125,122,120,123),
    (0,136,133,131,134), (0,147,144,142,145), (0,158,155,153,156), (0,169,166,164,167),
    (0,180,177,175,178), (0,191,188,186,189), (0,202,199,197,200), (0,213,210,208,211),
    (0,224,221,219,222), (0,235,232,230,233), (0,246,243,241,244), (0,257,254,252,255),
    (0,268,265,263,266), (0,279,276,274,277), (0,290,287,285,288),
    (1,37,34,32,35), (1,48,45,43,46), (1,59,56,54,57), (1,70,67,65,68), (1,81,78,76,79),
    (1,92,89,87,90), (1,103,100,98,101), (1,114,111,109,112), (1,141,138,136,139),
    (1,152,149,147,150), (1,163,160,158,161), (1,174,171,169,172), (1,185,182,180,183),
    (1,196,193,191,194), (1,207,204,202,205), (1,218,215,213,216), (1,229,226,224,227),
    (1,240,237,235,238), (1,251,248,246,249), (1,262,259,257,260), (1,273,270,268,271),
    (1,284,281,279,282), (1,295,292,290,293), (1,306,303,301,304)
]

# Named colors for LED mapping
COLOR_MAP: Dict[str, int] = {
    'red': 0x05, 'orange': 0x09, 'yellow': 0x0d, 'lime': 0x11, 'green': 0x19,
    'turquoise': 0x1d, 'cyan': 0x21, 'light_blue': 0x25, 'blue': 0x29,
    'dark_blue': 0x2d, 'purple': 0x31, 'fuchsia': 0x35, 'pink': 0x39,
    'off': 0x03
}

# Color display names for UI
COLOR_NAMES: List[str] = list(COLOR_MAP.keys())

# Color abbreviations for display
COLOR_ABBREV: Dict[str, str] = {
    'red': 'RD', 'orange': 'OR', 'yellow': 'YL', 'lime': 'LM', 'green': 'GR',
    'turquoise': 'TQ', 'cyan': 'CY', 'light_blue': 'LB', 'blue': 'BL',
    'dark_blue': 'DB', 'purple': 'PU', 'fuchsia': 'FU', 'pink': 'PK',
    'off': 'OF'
}

# Device layout mapping: (row, col) -> control_index in CONTROLS array
DEVICE_LAYOUT: Dict[str, List[Tuple[int, int]]] = {
    # Top row knobs (0-7)
    'knobs_top': [(0, col) for col in range(8)],
    # Middle row knobs (8-15) 
    'knobs_mid': [(1, col) for col in range(8)],
    # Bottom row knobs (16-23)
    'knobs_bot': [(2, col) for col in range(8)],
    # Sliders (24-31)
    'sliders': [(3, col) for col in range(8)],
    # Top button row (32-39)
    'buttons_top': [(4, col) for col in range(8)],
    # Bottom button row (40-47)
    'buttons_bot': [(5, col) for col in range(8)]
}